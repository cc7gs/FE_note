(self["webpackChunkFE_note"]=self["webpackChunkFE_note"]||[]).push([[2247],{1422:n=>{"use strict";n.exports={}},3859:(n,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>r});const r={}},4335:(n,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>c});var r=t(7294),a=t(6584),l=t(2196);t(3859);const c=n=>(r.useEffect((()=>{null!==n&&void 0!==n&&n.location.hash&&a.AnchorLink.scrollToAnchor(decodeURIComponent(n.location.hash.slice(1)))}),[]),r.createElement(r.Fragment,null,r.createElement("div",{className:"markdown"},r.createElement("p",null,"[toc]"),r.createElement("h1",{id:"\u5165\u95e8-async"},r.createElement(a.AnchorLink,{to:"#\u5165\u95e8-async","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u5165\u95e8 async"),r.createElement("p",null,r.createElement("strong",null,"async \u51fd\u6570\u662fGenerator\u51fd\u6570\u7684\u8bed\u6cd5\u7cd6\uff0c\u5728\u51fd\u6570\u5185\u90e8\u4f7f\u7528await\u6765\u8868\u793a\u5f02\u6b65\u3002"),r.createElement("strong",null,"\u7279\u70b9:")),r.createElement("ol",null,r.createElement("li",null,"async \u51fd\u6570 \u8fd4\u56de\u4e00\u4e2apromise\u5bf9\u8c61"),r.createElement("li",null,"\u5982\u4f55\u8fd4\u56de\u7684\u4e0d\u662fPromsie\u5bf9\u8c61\u5219\u4f1a\u88abPromise.resolve() \u5305\u88c5\u8fd4\u56de"),r.createElement("li",null,"async \u51fd\u6570\u53ef\u4ee5\u4f18\u96c5\u7684\u5904\u7406then\u94fe")),r.createElement("p",null,"==\u5148\u505a\u603b\u7ed3\u540e\u9762\u4f1a\u5bf9\u8be5\u7279\u5f81\u4e00\u4e00\u8bba\u8bc1=="),r.createElement("h2",{id:"\u4e00\u8d77\u770b\u4ee3\u7801"},r.createElement(a.AnchorLink,{to:"#\u4e00\u8d77\u770b\u4ee3\u7801","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u4e00\u8d77\u770b\u4ee3\u7801"),r.createElement("p",null,r.createElement("strong",null,"async \u51fd\u6570 \u8fd4\u56de\u4e00\u4e2apromise\u5bf9\u8c61")),r.createElement(l.Z,{code:"/**\r\n * 1. async \u51fd\u6570\u8fd4\u56de\u4e00\u4e2aPromise\u5bf9\u8c61\r\n * 2. \u51fd\u6570\u5185\u90e8 return \u8fd4\u56de\u7684\u503c\u4f1a\u88ab Promise.resolve()\u5305\u88c5\r\n * 3. \u51fd\u6570\u5185\u90e8\u5f02\u5e38\uff0c\u4f1a\u88ab catch\u65b9\u6cd5\u63a5\u6536\u5230\u3002\r\n */\r\nasync function test() {\r\n    return '1';\r\n}\r\nasync function test1() {\r\n    throw new Error('error');\r\n}\r\n//\u6d4b\u8bd5\u5982\u4e0b:\r\ntest();// Promise { '1' }\r\n\r\ntest1().then(v=>console.log(v,'value')).catch(e=>console.log(e,'\u6355\u83b7\u5230\u5f02\u5e38'));",lang:"javascript"}),r.createElement("h1",{id:"await-\u5230\u5e95\u5982\u4f55\u6267\u884c"},r.createElement(a.AnchorLink,{to:"#await-\u5230\u5e95\u5982\u4f55\u6267\u884c","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"await \u5230\u5e95\u5982\u4f55\u6267\u884c"),r.createElement("p",null,"await \u662f\u4e00\u4e2a\u8fd0\u7b97\u7b26,\u7528\u4e8e\u7ec4\u6210\u8868\u8fbe\u5f0f,await \u8868\u8fbe\u5f0f\u7684\u8fd0\u7b97\u7ed3\u679c\u53d6\u51b3\u4e8e\u5b83\u7b49\u7684\u4e1c\u897f\u3002"),r.createElement("ol",null,r.createElement("li",null,"\u5982\u679c\u5b83\u7b49\u7684\u4e0d\u662f\u4e00\u4e2aPromise \u5bf9\u8c61,\u90a3\u4e48await \u8868\u8fbe\u5f0f\u7684\u8fd0\u7b97\u7ed3\u679c\u5c31\u662f\u5b83\u7b49\u7684\u4e1c\u897f"),r.createElement("li",null,"\u5982\u679c\u5b83\u7b49\u5230\u7684\u662f\u4e00\u4e2aPromise\u5bf9\u8c61\uff0cawait\u5c31\u5fd9\u8d77\u6765\u4e86,",r.createElement("strong",null,"\u5b83\u4f1a\u963b\u585e\u540e\u9762\u7684\u4ee3\u7801,\u7b49\u7740Promise\u5bf9\u8c61 resolve"),",\u7136\u540e\u5f97\u5230resolve\u503c,\u4f5c\u4e3aawait\u8868\u8fbe\u5f0f\u7684\u8fd0\u7b97\u7ed3\u679c."),r.createElement("li",null,"await \u4f1a",r.createElement("strong",null,"\u5148\u6267\u884c\u7b49\u5f85\u7684\u51fd\u6570"),"\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u8ba9\u51fa\u7ebf\u7a0b\u963b\u585e\u540e\u9762\u7684\u4ee3\u7801")),r.createElement("p",null,r.createElement("strong",null,"await \u4f1a\u5148\u6267\u884c\u7b49\u5f85\u7684\u51fd\u6570\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u8ba9\u51fa\u7ebf\u7a0b\u963b\u585e\u540e\u9762\u7684\u4ee3\u7801")),r.createElement("p",null,"==\u63d0\u793a:== \u770b\u4e0b\u9762\u4ee3\u7801 ",r.createElement("strong",null,"async2 start")," \u4e0e ",r.createElement("strong",null,"scriptend"),"\u90a3\u4e2a\u5148\u6253\u5370."),r.createElement(l.Z,{code:"console.log('script start');\r\nasync function async1(){\r\n    console.log('async1 start');\r\n    await async2();\r\n    console.log('async end');\r\n}\r\nasync function async2(){\r\n    console.log('async2 start')\r\n}\r\nasync1();\r\nconsole.log('script end');\r\n//\u7ed3\u679c\u5982\u4e0b:\r\n/* \r\nscript start\r\nasync1 start\r\nasync2 start\r\nscript end\r\nasync end\r\n*/",lang:"javascript"}),r.createElement("p",null,r.createElement("strong",null,"\u5982\u679c\u5b83\u7b49\u7684\u4e0d\u662f\u4e00\u4e2aPromise \u5bf9\u8c61,\u90a3\u4e48await \u8868\u8fbe\u5f0f\u7684\u8fd0\u7b97\u7ed3\u679c\u5c31\u662f\u5b83\u7b49\u7684\u4e1c\u897f")),r.createElement(l.Z,{code:"console.log('script start');\r\nasync function async1(){\r\n    console.log('async1 start');\r\n    let wait=await async2();\r\n    console.log('await\u7b49\u5f85\u7684\u503c\uff1a',wait);\r\n    console.log('async end');\r\n}\r\nasync function async2(){\r\n    console.log('async2 start')\r\n    return 'async value';\r\n}\r\nasync1();\r\nconsole.log('script end');\r\n/*\r\nscript start\r\nasync1 start\r\nasync2 start\r\nscript end\r\nawait\u7b49\u5f85\u7684\u503c\uff1a async value\r\nasync end\r\n*/",lang:"javascript"}),r.createElement("p",null,"==\u63d0\u793a:== async2 \u8fd4\u56de\u7684\u4e0d\u662fPromise\u5bf9\u8c61 \u5219 await\u540e\u9762\u7684\u8bed\u8a00\u4f1a\u6253\u5370"),r.createElement("p",null,r.createElement("strong",null,"\u5982\u679c\u5b83\u7b49\u5230\u7684\u662f\u4e00\u4e2aPromise\u5bf9\u8c61\uff0cawait\u5c31\u5fd9\u8d77\u6765\u4e86,\u5b83\u4f1a\u963b\u585e\u540e\u9762\u7684\u4ee3\u7801,\u76f4\u5230\u7b49\u5f85\u7684Promsie \u5b9e\u73b0\u627f\u8bfa"),"==\u63d0\u793a:== await \u540e\u9762\u7684\u4ee3\u7801\u4e0d\u4f1a\u88ab\u6267\u884c"),r.createElement(l.Z,{code:"console.log('script start');\r\nasync function async1(){\r\n    console.log('async1 start');\r\n    let wait=await async2();\r\n    console.log('await\u7b49\u5f85\u7684\u503c\uff1a',wait);\r\n    console.log('async end');\r\n}\r\nasync function async2(){\r\n    console.log('async2 start')\r\n    return new Promise((resolve,reject)=>{\r\n        console.log('new Promsie in async2');    \r\n    })\r\n}\r\nasync1();\r\nconsole.log('script end');\r\n/*\r\nscript start\r\nasync1 start\r\nasync2 start\r\nnew Promsie in async2\r\nscript end\r\n*/",lang:"javascript"}),r.createElement("h1",{id:"await-\u4f18\u96c5\u7684\u5904\u7406then\u94fe"},r.createElement(a.AnchorLink,{to:"#await-\u4f18\u96c5\u7684\u5904\u7406then\u94fe","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"await \u4f18\u96c5\u7684\u5904\u7406then\u94fe"),r.createElement("p",null,r.createElement("strong",null,"\u6848\u4f8b:")," \u5047\u8bbe\u4e00\u4e2a\u4e1a\u52a1,\u5206\u6b65\u9aa4\u5b8c\u6210,\u6bcf\u4e2a\u6b65\u9aa4\u90fd\u662f\u5f02\u6b65,\u800c\u4e14\u4f9d\u8d56\u4e8e\u6bcf\u4e00\u4e2a\u6b65\u9aa4,\u5373\u4e0a\u4e2a\u6b65\u9aa4\u505a\u5b8c\u540e\u624d\u80fd\u505a\u4e0b\u4e00\u4e2a\u6b65\u9aa4"),r.createElement(l.Z,{code:"//\u7528 setimeout\u6a21\u62df\u5f02\u6b65\u6570\u636e\u8bf7\u6c42\r\nfunction takeLongTime(n){\r\n    return new Promise(resolve=>{\r\n        setTimeout(()=>{\r\n            resolve(n+200)\r\n        },n);\r\n    })\r\n}\r\n//\u4e0b\u9762\u662f\u6bcf\u4e2a\u6b65\u9aa4\r\nfunction setp1(n){\r\n    console.log(`step1 with ${n}`);\r\n    return takeLongTime(n);\r\n}\r\nfunction setp2(n){\r\n    console.log(`step2 with ${n}`);\r\n    return takeLongTime(n);\r\n}\r\nfunction setp3(n){\r\n    console.log(`step3 with ${n}`);\r\n    return takeLongTime(n);\r\n}",lang:"javascript"}),r.createElement("p",null,"\u5bf9\u4e1a\u52a1\u7684\u5904\u7406\u4ee3\u7801\u5982\u4e0b\uff1a"),r.createElement(l.Z,{code:"function doIt(){\r\n    console.time('doIt');\r\n    const time1=300;\r\n    setp1(time1)\r\n        .then(time2=>setp1(time2))\r\n        .then(time3=>setp1(time3))\r\n        .then(result=>{\r\n            console.log('result is',result);\r\n            console.timeEnd('doIt');\r\n        });\r\n}\r\ndoIt();\r\n/*\r\nscript start\r\nstep1 with 300\r\nstep1 with 500\r\nstep1 with 700\r\nresult is 900\r\ndoIt: 1529.517ms\r\n*/",lang:"javascript"}),r.createElement("p",null,r.createElement("strong",null,"\u73b0\u5728\u6211\u4eec\u7528 async\u6539\u5199\u4e0a\u9762\u7684doIt\u51fd\u6570")),r.createElement(l.Z,{code:"async function doIt(){\r\n    console.time('doIt');\r\n    const time1=300;\r\n    const time2=await setp1(time1);\r\n    const time3=await setp1(time2);\r\n    const result=await setp1(time3);\r\n    console.log('result',result);\r\n    console.timeEnd('doIt');\r\n}\r\ndoIt();",lang:"javascript"}),r.createElement("p",null,"\u539f\u6587\u4e2d\u5de6\u53f3\u6700\u540e\u90a3\u4e2ademo\u5bf9\u4e0a\u9762\u6848\u4f8b\u505a\u51fa\u9700\u6c42\u66f4\u6539\uff0c\u5373\u6bcf\u4e2a\u4efb\u52a1\u90fd\u4f9d\u8d56\u4e0a\u4e2a\u4efb\u52a1\u7684\u7ed3\u679c\u3002"),r.createElement("h1",{id:"\u7ed3\u5c3e"},r.createElement(a.AnchorLink,{to:"#\u7ed3\u5c3e","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u7ed3\u5c3e"),r.createElement("p",null,"\u4ee5\u4e0a\u662f\u6211\u5bf9 \u8fb9\u57ce\u4f5c\u8005\u539f\u6587\u540e\u5b9e\u6218\u6240\u5f97\u7684\u4e00\u4e9b\u81ea\u5df1\u7406\u89e3,\u82e5\u7406\u89e3\u6709\u8bef\u5927\u5bb6\u53ef\u4ee5\u8bc4\u8bba\u533a\u63a2\u8ba8\u3002"),r.createElement("p",null,r.createElement(a.Link,{to:"https://segmentfault.com/a/1190000007535316"},"\u539f\u6587\u5730\u5740")))))}}]);