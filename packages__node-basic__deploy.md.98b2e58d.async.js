(self["webpackChunkFE_note"]=self["webpackChunkFE_note"]||[]).push([[5437],{1422:e=>{"use strict";e.exports={}},3859:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>l});const l={}},6586:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>c});var l=t(7294),a=t(6584),o=t(2196);t(3859);const c=e=>(l.useEffect((()=>{null!==e&&void 0!==e&&e.location.hash&&a.AnchorLink.scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),l.createElement(l.Fragment,null,l.createElement("div",{className:"markdown"},l.createElement("h1",{id:"\u4e0a\u7ebf\u90e8\u7f72"},l.createElement(a.AnchorLink,{to:"#\u4e0a\u7ebf\u90e8\u7f72","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e0a\u7ebf\u90e8\u7f72"),l.createElement("p",null,"==**== \u642d\u5efa\u524d\u5148\u66f4\u65b0\u7cfb\u7edf $ sudo apt-get update"),l.createElement("h2",{id:"\u642d\u5efa-nodejs-\u73af\u5883"},l.createElement(a.AnchorLink,{to:"#\u642d\u5efa-nodejs-\u73af\u5883","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u642d\u5efa node.js \u73af\u5883"),l.createElement(o.Z,{code:"//\u5b89\u88c5\u7cfb\u7edf\u76f8\u5173\u5de5\u5177\nsudo apt-get install git\n// open ssl build-essential libssl-dev wget",lang:"unknown"}),l.createElement("h3",{id:"\u5b89\u88c5-nodejs"},l.createElement(a.AnchorLink,{to:"#\u5b89\u88c5-nodejs","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u5b89\u88c5 node.js"),l.createElement("p",null,"\u8fd9\u91cc\u901a\u8fc7 nvm \u6765\u5b89\u88c5 node.js \u6b65\u9aa4\u5982\u4e0b:"),l.createElement("p",null,l.createElement(a.Link,{to:"https://github.com/nvm-sh/nvm"},"github \u5730\u5740")),l.createElement(o.Z,{code:"wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash\n\n//\u91cd\u65b0\u6253\u5f00\u4e00\u4e2a\u7a97\u53e3\n$ nvm  //\u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f",lang:"unknown"}),l.createElement("ol",null,l.createElement("li",null,"\u5b89\u88c5 node.js",l.createElement("blockquote",null,l.createElement("p",null,"nvm install v10.14.2"))),l.createElement("li",null,"\u6307\u5b9a\u7248\u672c",l.createElement("blockquote",null,l.createElement("p",null,"nvm use v10.14.2")))),l.createElement("p",null,"==**== \u6216\u8005\u8bbe\u5b9a\u9ed8\u8ba4 nodejs \u7248\u672c"),l.createElement("blockquote",null,l.createElement("p",null,"nvm alias default v10.14.2")),l.createElement("h3",{id:"\u5de5\u5177\uff08pm2\uff09"},l.createElement(a.AnchorLink,{to:"#\u5de5\u5177\uff08pm2\uff09","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u5de5\u5177\uff08pm2\uff09"),l.createElement("p",null,"nrm \u7ba1\u7406\u7528\u4e8e\u7ba1\u7406 npm,\u5207\u6362\u76f8\u5173\u955c\u50cf"),l.createElement(o.Z,{code:"npm i pm2 nrm -g",lang:"unknown"}),l.createElement("p",null,l.createElement("strong",null,"nrm \u57fa\u672c\u4f7f\u7528")),l.createElement(o.Z,{code:"// \u67e5\u770b\u76f8\u5173\u6e90\nnrm ls\n// \u5207\u6362\u6e90\u5230 cnpm\nnrm use cnpm",lang:"javascript"}),l.createElement("p",null,l.createElement("strong",null,"pm2 \u57fa\u672c\u4f7f\u7528")),l.createElement(o.Z,{code:"# \u542f\u52a8app.js\u5e94\u7528\u7a0b\u5e8f\n$ pm2 start app.js\n\n# \u5f53\u6587\u4ef6\u53d1\u6210\u53d8\u5316\u65f6\u91cd\u542f\n$ pm2 start app.js --watchpm\n\n# \u5217\u51fapm2 \u542f\u52a8\u7684\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\n$ pm2  list\n\n# \u67e5\u770b\u5e94\u7528\u7a0b\u5e8f\u7684\u6240\u6709\u4fe1\u606f\n$ pm2 show [name]\n# \u67e5\u770b\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\n$ pm2 logs\n\n# \u9000\u51fa\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\n$ pm2 stop all\n\n#\u91cd\u542f\u6240\u6709\u5e94\u7528\n$ pm2 restart all\n\n# \u5220\u9664\u6240\u6709\u5e94\u7528\n$ pm2 delete all\n# \u76d1\u63a7\u670d\u52a1\n$ pm2 monit\n\u82e5\u60f3\u64cd\u4f5c\u67d0\u4e00\u4e2a\u5219 \u5c06 all \u66ff\u6362\u4e3a\u8be5\u5e94\u7528\u540d\u79f0\u6216\u8005id\u5373\u53ef\u3002",lang:"unknown"}),l.createElement("h2",{id:"\u914d\u7f6e-nginx"},l.createElement(a.AnchorLink,{to:"#\u914d\u7f6e-nginx","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u914d\u7f6e nginx"),l.createElement("ol",null,l.createElement("li",null,"\u5b89\u88c5 nginx",l.createElement("blockquote",null,l.createElement("p",null,"sudo apt-get install nginx"))),l.createElement("li",null,"\u67e5\u770b\u7248\u672c",l.createElement("blockquote",null,l.createElement("p",null,"nginx -v"))),l.createElement("li",null,"\u542f\u52a8")),l.createElement(o.Z,{code:"sudo nginx  #\u542f\u52a8\nnginx -s reload  # \u4fee\u6539\u914d\u7f6e\u540e\u91cd\u65b0\u52a0\u8f7d\u751f\u6548\nnginx -s quit  # \u9000\u51fa",lang:"unknown"}),l.createElement("ol",null,l.createElement("li",null,"\u76f8\u5173\u914d\u7f6e:")),l.createElement(o.Z,{code:"# \u67e5\u770bnginx\u76ee\u5f55\u5185\u5bb9\ncd /etc/nginx\n\n# \u65b0\u5efa\u914d\u7f6e\u6587\u4ef6\nsudo vim  /etc/nginx/conf.d/ccwgs-top-8081.conf\n\n//\u5185\u5bb9\u5982\u4e0b\nupstream ccwgs{\n  server 127.0.0.1:8081;\n}\nserver{\n  listen 80;\n  server_name 106.15.185.114;\n\n  location / {\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forward-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Nginx-Proxy true;\n\n    proxy_pass http://ccwgs.top\n    proxy_redirect off;\n  }\n}\n\n# \u8fdb\u5165 nginx.conf\n$ sudo vim /etc/nginx/nginx.conf\n\n# \u68c0\u67e5\u8be5\u53e5\u662f\u5426\u6253\u5f00(\u9ed8\u8ba4\u5e94\u8be5\u6253\u5f00)\n include /etc/nginx/conf.d/*.conf",lang:"unknown"}),l.createElement("ol",{start:5},l.createElement("li",null,"\u6d4b\u8bd5\u914d\u7f6e sudo nginx -t")),l.createElement("h2",{id:"\u5b89\u88c5\u6570\u636e\u5e93ubuntu"},l.createElement(a.AnchorLink,{to:"#\u5b89\u88c5\u6570\u636e\u5e93ubuntu","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u5b89\u88c5\u6570\u636e\u5e93(ubuntu)"),l.createElement("ol",null,l.createElement("li",null,"\u5b89\u88c5\u6b65\u9aa4(Community \u7248) ",l.createElement(a.Link,{to:""},"MongoD \u5b98\u7f51\u5b89\u88c5")," \u5982\u679c\u5b89\u88c5\u5931\u8d25\uff0c\u53ef\u4ee5\u5148\u5c4f\u853d\u963f\u91cc\u6e90"),l.createElement("li",null,"\u5f00\u542f\u670d\u52a1 sudo service mongod start"),l.createElement("li",null,"\u67e5\u770b\u670d\u52a1\u65e5\u5fd7\u662f\u5426\u542f\u52a8\u6210\u529f cat /var/log/mongodb/mongod.log"),l.createElement("li",null,"\u4fee\u6539 mongodb \u7aef\u53e3 sudo vi /etc/mongod.conf")),l.createElement(o.Z,{code:"port: xxxx",lang:"unknown"}),l.createElement("h3",{id:"\u6dfb\u52a0\u6743\u9650\u63a7\u5236\u89d2\u8272"},l.createElement(a.AnchorLink,{to:"#\u6dfb\u52a0\u6743\u9650\u63a7\u5236\u89d2\u8272","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u6dfb\u52a0\u6743\u9650\u63a7\u5236(\u89d2\u8272)"),l.createElement("p",null,"MongoDB \u767b\u5f55\u8ba4\u8bc1\u9ed8\u8ba4\u662f\u5173\u95ed\u7684\uff0c\u4e0b\u9762\u662f\u5f00\u542f\u8ba4\u8bc1\u6d41\u7a0b:"),l.createElement("ol",null,l.createElement("li",null,"\u6dfb\u52a0\u8d85\u7ea7\u7ba1\u7406\u5458")),l.createElement(o.Z,{code:"//\u542f\u52a8mongodb \u547d\u4ee4\u884c\n> mongo\n> use admin\n> db.createUser({user:'',pwd:'',roles:[{role:'userAdminAnyDatabase',db:'admin'}]})\n//\u6388\u6743 \u7528\u6237\u540d\u548c\u5bc6\u7801\n> db.auth('','')",lang:"unknown"}),l.createElement("ol",{start:2},l.createElement("li",null,"\u67d0\u4e2a\u6570\u636e\u5e93 blogapi \u7528\u6237\u5e76\u5206\u914d\u6743\u9650")),l.createElement(o.Z,{code:"//\u542f\u52a8mongodb \u547d\u4ee4\u884c\uff0c\u8fdb\u5165admin\n> mongo\n> use admin\n//\u6388\u6743 \u7528\u6237\u540d\u548c\u5bc6\u7801\uff08\u521b\u5efa\u8d85\u7ea7\u7ba1\u7406\u5458\u7684\u8d26\u6237\u5bc6\u7801\uff09\n> db.auth('','')\n> use blogapi\n> db.createUser({user:'',pwd:'',roles:[{role:'readWrite',db:'blogapi']})",lang:"unknown"}),l.createElement("ol",{start:3},l.createElement("li",null,"\u4fee\u6539\u914d\u7f6e\u6587\u4ef6")),l.createElement(o.Z,{code:'> sudo vi /etc/mongod.conf\n# \u6253\u5f00 security \u6dfb\u52a0\u8ba4\u8bc1\nsecurity:\n  authorization: "enabled"\n//\u914d\u7f6e\u751f\u6548(\u91cd\u542fmongodb)\n> sudo service mongod restart',lang:"unknown"}),l.createElement("ol",{start:4},l.createElement("li",null,"\u767b\u5f55\u914d\u7f6e\u6743\u9650\u6570\u636e\u5e93",l.createElement("blockquote",null,l.createElement("p",null,"mongo 127.0.0.1:27017/[\u6570\u636e\u5e93\u540d] -u [\u7528\u6237\u540d] -p [\u5bc6\u7801]")))),l.createElement(o.Z,{code:"- \u5e38\u7528\u7684role\u503c\u8bb0\u5f55:\n1. \u6570\u636e\u5e93\u7528\u6237\u89d2\u8272\uff1aread\u3001readWrite;\n2. \u6570\u636e\u5e93\u7ba1\u7406\u89d2\u8272\uff1adbAdmin\u3001dbOwner\u3001userAdmin\uff1b\n3. \u96c6\u7fa4\u7ba1\u7406\u89d2\u8272\uff1aclusterAdmin\u3001clusterManager\u3001clusterMonitor\u3001hostManager\uff1b\n4. \u5907\u4efd\u6062\u590d\u89d2\u8272\uff1abackup\u3001restore\uff1b\n5. \u6240\u6709\u6570\u636e\u5e93\u89d2\u8272\uff1areadAnyDatabase\u3001readWriteAnyDatabase\u3001userAdminAnyDatabase\u3001dbAdminAnyDatabase\n6. \u8d85\u7ea7\u7528\u6237\u89d2\u8272\uff1aroot\n7. \u5185\u90e8\u89d2\u8272\uff1a__system\n\n- \u76f8\u5e94\u7684\u529f\u80fd\n- Read\uff1a\u5141\u8bb8\u7528\u6237\u8bfb\u53d6\u6307\u5b9a\u6570\u636e\u5e93\n- readWrite\uff1a\u5141\u8bb8\u7528\u6237\u8bfb\u5199\u6307\u5b9a\u6570\u636e\u5e93\n- dbAdmin\uff1a\u5141\u8bb8\u7528\u6237\u5728\u6307\u5b9a\u6570\u636e\u5e93\u4e2d\u6267\u884c\u7ba1\u7406\u51fd\u6570\uff0c\u5982\u7d22\u5f15\u521b\u5efa\u3001\u5220\u9664\uff0c\u67e5\u770b\u7edf\u8ba1\u6216\u8bbf\u95eesystem.profile\n- userAdmin\uff1a\u5141\u8bb8\u7528\u6237\u5411system.users\u96c6\u5408\u5199\u5165\uff0c\u53ef\u4ee5\u627e\u6307\u5b9a\u6570\u636e\u5e93\u91cc\u521b\u5efa\u3001\u5220\u9664\u548c\u7ba1\u7406\u7528\u6237\n- clusterAdmin\uff1a\u53ea\u5728admin\u6570\u636e\u5e93\u4e2d\u53ef\u7528\uff0c\u8d4b\u4e88\u7528\u6237\u6240\u6709\u5206\u7247\u548c\u590d\u5236\u96c6\u76f8\u5173\u51fd\u6570\u7684\u7ba1\u7406\u6743\u9650\u3002\n- readAnyDatabase\uff1a\u53ea\u5728admin\u6570\u636e\u5e93\u4e2d\u53ef\u7528\uff0c\u8d4b\u4e88\u7528\u6237\u6240\u6709\u6570\u636e\u5e93\u7684\u8bfb\u6743\u9650\n- readWriteAnyDatabase\uff1a\u53ea\u5728admin\u6570\u636e\u5e93\u4e2d\u53ef\u7528\uff0c\u8d4b\u4e88\u7528\u6237\u6240\u6709\u6570\u636e\u5e93\u7684\u8bfb\u5199\u6743\u9650\n- userAdminAnyDatabase\uff1a\u53ea\u5728admin\u6570\u636e\u5e93\u4e2d\u53ef\u7528\uff0c\u8d4b\u4e88\u7528\u6237\u6240\u6709\u6570\u636e\u5e93\u7684userAdmin\u6743\u9650\n- dbAdminAnyDatabase\uff1a\u53ea\u5728admin\u6570\u636e\u5e93\u4e2d\u53ef\u7528\uff0c\u8d4b\u4e88\u7528\u6237\u6240\u6709\u6570\u636e\u5e93\u7684dbAdmin\u6743\u9650\u3002\n- root\uff1a\u53ea\u5728admin\u6570\u636e\u5e93\u4e2d\u53ef\u7528\u3002\u8d85\u7ea7\u8d26\u53f7\uff0c\u8d85\u7ea7\u6743\u9650",lang:"unknown"}),l.createElement("p",null,l.createElement(a.Link,{to:"https://www.scaleway.com/en/docs/install-and-secure-mongodb-on-ubuntu/"},"\u53c2\u8003\u5730\u5740")),l.createElement("h3",{id:"\u57fa\u672c\u547d\u4ee4"},l.createElement(a.AnchorLink,{to:"#\u57fa\u672c\u547d\u4ee4","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u57fa\u672c\u547d\u4ee4"),l.createElement("ol",null,l.createElement("li",null,"\u5f00\u542f\u670d\u52a1",l.createElement("blockquote",null,l.createElement("p",null,"sudo service mongod start"))),l.createElement("li",null,"\u505c\u6b62\u670d\u52a1",l.createElement("blockquote",null,l.createElement("p",null,"sudo service mongod stop"))),l.createElement("li",null,"\u91cd\u542f\u670d\u52a1",l.createElement("blockquote",null,l.createElement("p",null,"sudo service mongod restart"))),l.createElement("li",null,"\u6307\u5b9a\u7aef\u53e3\u542f\u52a8",l.createElement("blockquote",null,l.createElement("p",null,"mongo --port [\u7aef\u53e3\u53f7]"))),l.createElement("li",null,"\u67e5\u770b\u72b6\u6001",l.createElement("blockquote",null,l.createElement("p",null,"sudo service mongod status"))),l.createElement("li",null,"\u6570\u636e\u5907\u4efd",l.createElement("blockquote",null,l.createElement("p",null,"mongodump -h 127.0.0.1:27017 -d [\u6570\u636e\u5e93\u540d] -0 [\u6587\u4ef6\u5730\u5740]"))),l.createElement("li",null,"\u5bfc\u5165\u6570\u636e\u5e93",l.createElement("blockquote",null,l.createElement("p",null,"mongorestore --host 127.0.0.1:27017 -d [\u6570\u636e\u5e93\u540d] [\u5bfc\u5165\u6587\u4ef6\u5730\u5740]"))),l.createElement("li",null,"\u5bfc\u51fa\u5355\u8868",l.createElement("blockquote",null,l.createElement("p",null,"mongoexport -d [\u6570\u636e\u5e93\u540d] -c [\u8868\u540d] -o [\u5bfc\u51fa\u5730\u5740]"))),l.createElement("li",null,"\u6e05\u7a7a\u6570\u636e\u5e93",l.createElement("blockquote",null,l.createElement("p",null,'mongo --host 127.0.0.1:27017 [\u6570\u636e\u5e93\u540d] --eval "db.dropDatabase()"')))),l.createElement("h1",{id:"\u78b0\u5230\u95ee\u9898"},l.createElement(a.AnchorLink,{to:"#\u78b0\u5230\u95ee\u9898","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u78b0\u5230\u95ee\u9898"),l.createElement("ol",null,l.createElement("li",null,"\u901a\u8fc7 node \u8fd0\u884c\u9759\u6001\u7f51\u7ad9 \u65e0\u6cd5\u8bbf\u95ee 3001 \u7aef\u53e3\u7531\u4e8e\u963f\u91cc\u4e91\u6ca1\u6709\u5f00\u653e\u8be5\u7aef\u53e3\uff0c\u5219\u9700\u8981\u5728\u5b89\u5168\u7ec4\u4e2d\u5c06\u7aef\u53e3\u5f00\u53d1\uff0c\u5177\u4f53\u64cd\u4f5c\u6d41\u7a0b\u53ef\u4ee5\u641c\u7d20 \u963f\u91cc\u4e91\u6dfb\u52a0\u5b89\u5168\u7ec4\u76f8\u5e94\u5173\u952e\u5b57\u3002"),l.createElement("li",null,'nginx: "/run/nginx.pid" failed (2: No such file or directory) \u5728\u963f\u91cc\u4e91\u670d\u52a1\u5668\u4e0a\uff0c\u8fdb\u7a0b\u6027\u7684 nginx -s stop \u540e\u518d\u6b21\u542f\u52a8 nginx -s reload \u5c31\u4f1a\u51fa\u73b0\u8fd9\u4e2a\u9519\u8bef\uff0c\u539f\u56e0\u5982\u4e0b:nginx \u8fdb\u7a0b\u6740\u6b7b\u540e pid \u4e22\u5931\u4e86\uff0c\u4e0b\u4e00\u6b21\u518d\u5f00\u542f nginx -s reload \u65f6\u65e0\u6cd5\u542f\u52a8\uff0c\u91cd\u88c5\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898')),l.createElement(o.Z,{code:"nginx -c /path/to/config/file\n#\u6211\u7684\u7cfb\u7edf(\u963f\u91cc\u4e91 ubuntu16)\nsudo nginx -c /etc/nginx/nginx.conf",lang:"unknown"}),l.createElement("p",null,"\u6216\u8005\u76f4\u63a5\u542f\u52a8 $ nginx 3. Unrecognized option: securit \u9996\u5148\u786e\u4fdd\u5355\u8bcd\u62fc\u5199\u65e0\u8bef\uff0c\u7136\u540e\u68c0\u67e5 ':' \u540e\u5e94\u8be5\u6709\u7a7a\u683c\uff0c\u5982\u4e0b\u9762\u5f62\u5f0f:"),l.createElement(o.Z,{code:"authorization: 'enabled'",lang:"unknown"}),l.createElement("ol",{start:4},l.createElement("li",null,"\u5728 window \u7cfb\u7edf\u4e0b vsocode \u547d\u4ee4\u4e0b\u8fd0\u884c,\u51fa\u73b0 \u90e8\u7f72\u5931\u8d25")),l.createElement("p",null,l.createElement(a.Link,{to:"https://github.com/Unitech/pm2/issues/3839"},"\u539f\u6587\u5730\u5740")),l.createElement(o.Z,{code:"1. \u65b9\u6cd5\u4e00\n\u5c06  C:\\Program Files\\Git\\bin \u52a0\u5165\u5230 path\u8def\u5f84\u4e2d\n2. \u65b9\u6cd5\u4e8c\n\u4f7f\u7528 git\u547d\u4ee4\u884c\u5de5\u5177 bash",lang:"unknown"}),l.createElement("ol",{start:5},l.createElement("li",null,"pm2 Permission denied")),l.createElement(o.Z,{code:'// ecosystem.json \u4e3a\u4f8b\n"path": "/www/blogService/production",\n//\u4fee\u6539blogService\u6587\u4ef6\u6743\u9650\nsudo chmod 777 xxx',lang:"unknown"}),l.createElement("ol",{start:6},l.createElement("li",null,"Unexpected token ","{"," in cli.js #45699 ",l.createElement(a.Link,{to:"https://www.twblogs.net/a/5c91b00dbd9eee35cd6b6dd7"},"https://www.twblogs.net/a/5c91b00dbd9eee35cd6b6dd7")),l.createElement("li",null,"bash pm2:command not found \u5df2\u7ecf\u5168\u5c40\u5b89\u88c5\uff0c\u5728 ubuntu \u4e2d\u81ea\u52a8\u90e8\u7f72\u4ecd\u7136\u62a5\u9519,\u539f\u56e0\u5982\u4e0b: \u56e0\u4e3a\u672c\u5730\u6267\u884c pm2 deploy \u4f7f\u7528\u7684 ssh \u6267\u884c\u8fdc\u7a0b\u547d\u4ee4\uff0c\u975e\u4ea4\u4e92\u5f0f\u73af\u5883."),l.createElement("li",null,'yarn \u9519\u8bef The engine "node" is incompatible with this module')),l.createElement(o.Z,{code:"yarn config set ignore-engines true",lang:"unknown"}),l.createElement("p",null,".bashrc"),l.createElement(o.Z,{code:'export NVM_DIR="/root/.nvm"\n[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"  # This loads nvm\n```cat\n[\u89e3\u51b3\u5730\u5740](https://github.com/Unitech/pm2-deploy/issues/41 )\n\n# Linux\u7cfb\u7edf\u77e5\u8bc6\n\n## linux \u76ee\u5f55\u7ed3\u6784\n  -bin  \u5b58\u653e\u4e8c\u8fdb\u5236\u6587\u4ef6(\u53ef\u6267\u884c\u547d\u4ee4)\n  -usr  \u5b58\u653e\u5b89\u88c5\u7a0b\u5e8f(\u8f6f\u4ef6\u9ed8\u8ba4\u76ee\u5f55)\n  -var  \u5b58\u653e\u7ecf\u5e38\u53d8\u5316\u7684\u6587\u4ef6(\u4e34\u65f6\u6587\u4ef6 \u65e5\u5fd7\u7b49)\n  -home \u666e\u901a\u7528\u6237\u6587\u4ef6\n  -dev \u5b58\u653e\u62bd\u8c61\u786c\u76d8\n  -lib  \u5b58\u653e\u7cfb\u7edf\u5e93\u6587\u4ef6\n  -etc  \u5b58\u653e\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\n  -root \u7279\u6743\u7528\u6237\u76ee\u5f55(\u8d85\u7ea7\u7ba1\u7406\u5458)\n  -opt  \u5927\u578b\u8f6f\u4ef6\u5b58\u653e\u76ee\u5f55\n  -mnt  \u6587\u4ef6\u6302\u8f7d\u76ee\u5f55\n  -boot\n  -sbin\n\n\n## \u914d\u7f6e\u9632\u62a4\u5899 iptables\n1. sudo iptables -F \u60c5\u51b5\u547d\u4ee4\u884c\u89c4\u5219\n//\u521b\u5efa\u6587\u4ef6\n2. sudo vi  /etc/iptables.up.rules\n3. \u7f16\u8f91\u5982\u4e0b\u5185\u5bb9',lang:"unknown"}),l.createElement("p",null,"*filter"),l.createElement("h1",{id:"allow-all-connections"},l.createElement(a.AnchorLink,{to:"#allow-all-connections","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"allow all connections"),l.createElement("p",null,"-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT"),l.createElement("h1",{id:"allow-out-traffic"},l.createElement(a.AnchorLink,{to:"#allow-out-traffic","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"allow out traffic"),l.createElement("p",null,"-A OUTPUT -j ACCEPT"),l.createElement("h1",{id:"allow-http-https"},l.createElement(a.AnchorLink,{to:"#allow-http-https","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"allow http https"),l.createElement("p",null,"-A INPUT -P tcp --dport 443 -j ACCEPT -A INPUT -P TCP --dport 80 -j ACCEPT"),l.createElement("h1",{id:"\u767b\u5f55"},l.createElement(a.AnchorLink,{to:"#\u767b\u5f55","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u767b\u5f55"),l.createElement("p",null,"-A INPUT -P TCP -m state --sate NEW --dport 22 -j ACCEPT"),l.createElement("p",null,"#ping -A INPUT -P icmp -m icmp --icmp-type 8 -j ACCEPT"),l.createElement("h1",{id:"mongodb-connect"},l.createElement(a.AnchorLink,{to:"#mongodb-connect","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"mongodb connect"),l.createElement("p",null,"-A INPUT -s 127.0.0.1 -p tcp --destination-port 27017 -m start --state NEW,ESTABLISHED -j ACCEPT -A OUTPUT -d 127.0.0.1 -p tcp --source-port 27017 -m start --state ESTABLISHED -j ACCEPT"),l.createElement("p",null,'#log denied calls -A INPUT -m limit --limit 5/min -g LOG --log-prefix "iptables denied:" --log-level 7'),l.createElement("h1",{id:"drop-incoming-sensitive-connections"},l.createElement(a.AnchorLink,{to:"#drop-incoming-sensitive-connections","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"drop incoming sensitive connections"),l.createElement("ul",null,l.createElement("li",null,"A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --set"),l.createElement("li",null,"A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -M recent --update --seconds 60 --hitcount 150 -j DROP")),l.createElement("h1",{id:"reject-all-other-inbound"},l.createElement(a.AnchorLink,{to:"#reject-all-other-inbound","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"reject all other inbound"),l.createElement("p",null,"-A INPUT -j REJECT -A FORWARD -j REJECT"),l.createElement("p",null,"COMMIT"),l.createElement(o.Z,{code:"1. sudo iptables-restore < /etc/iptables.up.rules //\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\u662f\u5426\u6b63\u786e\n2. sudo ufw status //\u67e5\u770b\u9632\u706b\u5899\u72b6\u6001\n3. sudo ufw enable // \u6fc0\u6d3b\u9632\u706b\u5899\n\n### \u9632\u706b\u5899 \u5f00\u673a\u542f\u52a8\u914d\u7f6e\n1. sudo vi /etc/network/if-up.d/iptables",lang:"unknown"}),l.createElement("h1",{id:"binsh"},l.createElement(a.AnchorLink,{to:"#binsh","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"!/bin/sh"),l.createElement("p",null,"iptables-restore /etc/iptables.up.rules"),l.createElement(o.Z,{code:"2. \u7ed9\u4e88\u6743\u9650\n    chmod +x /etc/network/if-up.d/iptables\n### fail2ban \u9632\u5fa1\u6a21\u5757\nfail2Ban \u662f\u4e00\u6b3e\u5165\u4fb5\u9632\u5fa1\u8f6f\u4ef6\uff0c\u53ef\u4ee5\u4fdd\u62a4\u670d\u52a1\u5668\u514d\u53d7\u66b4\u529b\u653b\u51fb\u3002\u57fa\u4e8eauth \u65e5\u5fd7\u6587\u4ef6\u5de5\u4f5c\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b83\u4f1a\u626b\u63cf\u6240\u6709 auth \u65e5\u5fd7\u6587\u4ef6\u3002\n1. \u5b89\u88c5\n   1. sudo apt-get install fail2ban\n2. \u6253\u5f00\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\n   1. sudo vi /etc/fail2ban/fail.conf",lang:"unknown"}),l.createElement("h1",{id:"\u53ef\u4ee5\u4fee\u6539\u4e3a\u81ea\u5df1\u7684\u90ae\u7bb1"},l.createElement(a.AnchorLink,{to:"#\u53ef\u4ee5\u4fee\u6539\u4e3a\u81ea\u5df1\u7684\u90ae\u7bb1","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u53ef\u4ee5\u4fee\u6539\u4e3a\u81ea\u5df1\u7684\u90ae\u7bb1"),l.createElement("p",null,"destemail=",l.createElement(a.Link,{to:"mailto:101303709@qq.com"},"101303709@qq.com")),l.createElement(o.Z,{code:"\u5176\u5b83\u914d\u7f6e\u53ef\u4ee5\u81ea\u884c\u767e\u5ea6\u641c\u7d22\u4fee\u6539\u3002\n3. sudo service fail2ban status //\u67e5\u770b\u72b6\u6001\n4. sudo  service fail2ban start  //\u542f\u52a8\n\n## \u5176\u5b83\n\n- \u4fee\u6539ssh\u7aef\u53e3\n  vi /etc/ssh/sshd_config\nsudo service ssh restar",lang:"unknown"}))))}}]);